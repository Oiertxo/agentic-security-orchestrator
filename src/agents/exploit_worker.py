from langchain_core.messages import AIMessage
from src.state import AgentState
from src.logger import logger

def exploit_worker_node(state: AgentState) -> AgentState:
    logger.info("--- MOCK EXPLOIT ---")

    technical_output = """
        [SOURCE: EXPLOIT]
        TARGET: 10.255.255.10
        FINDINGS:
        - OBTAINED REMOTE SHELL
        [/END_REPORT]
        """
    
    return {
        "messages": [AIMessage(content=technical_output)],
        "next_step": "supervisor",
        "exploit": {
            "findings": [{
                "10.255.255.10": "OBTAINED REMOTE SHELL"
            }]
        }
    }